function saveLPaymentRelations(gfPayment,loyverseId,spinerId){let $spinner=$(`#${spinerId}`);$spinner.removeClass("visually-hidden");var settings={url:"/sessionservices/payments.php",method:"POST",data:JSON.stringify({integrationId:parseInt("<?php echo $integration->Id ?>"),gfPayment:gfPayment,loyverseId:loyverseId}),success:function(response){console.log(response),$spinner.addClass("visually-hidden"),showAlert(`${response.GfPayment} Saved Successfully`)},error:function(x,e){console.log(e),console.log(x),showAlert(`${response.GfPayment} Not Saved!`,!0),$spinner.addClass("visually-hidden")}};$.ajax(settings)}function loadLPaymentRelations(){let $select=$("#slPayments");$select.empty();var $option=$("<option></option>",{text:"(select one)",value:"0"});$select.append($option),$.each(lpayments,(function(k,v){$option=$("<option></option>",{text:v.name,value:v.id}),$select.append($option)})),$select.val("<?php echo $payemntRelations->LoyveresId??0 ?>")}let lpaymentsLoaded=!1,lpayments=[];var tblpaymentRelations=$("#tblpaymentRelations").DataTable({dom:"t",ajax:{url:"/sessionservices/payments.php?iid=<?php echo $integration->Id ?>",dataType:"json",type:"GET"},columns:[{data:"GfPayment"},{data:"LoyveresId",searchable:!1,orderable:!1,render:function(data,type,row,meta){!1===lpaymentsLoaded&&(lpaymentsLoaded=!0,lpayments=row.lpayments);var $select=$(`<select  id='sl-${row.GfPayment}'class="form-select form-select-sm mb-1 slPayments" aria-label=".form-select-lg slPayments"></select>`,{id:row.GfPayment+"start"}),$option=$("<option></option>",{text:"(select one)",value:"0"});return $select.append($option),$.each(row.lpayments,(function(k,v){$option=$("<option></option>",{text:v.name,value:v.id}),row.LoyveresId===v.id&&$option.attr("selected","selected"),$select.append($option)})),$select.prop("outerHTML")}},{visible:!0,orderable:!1,searchable:!1,render:function(data,type,row,meta){return`<span class="spinner spinner-border text-secondary spinner-border-sm float-end visually-hidden" id="prSpinner-${row.GfPayment}" role="status">\n            </span>`}}],createdRow:function(row,data,dataIndex){$(row).addClass("payments ")}});tblpaymentRelations.on("draw",(function(){loadLPaymentRelations()})),$(document).ready((function(){$(document).on("click","#btnSavePayments",(function(){$(tblpaymentRelations.rows().nodes()).each((k,v)=>{let $spinnerId=$(v).find(".spinner").attr("id"),$select=$(v).find("select"),$gfPayment,$loyverseId;saveLPaymentRelations(tblpaymentRelations.row(v).data().GfPayment,$select.val(),$spinnerId)})})),$(document).on("click","#btnSaveDefaultPayment",(function(){let $spinnerId=$("#pr-spinner").attr("id"),$select,$gfPayment="default",$loyverseId;saveLPaymentRelations("default",$("#slPayments").val(),$spinnerId)}))}));