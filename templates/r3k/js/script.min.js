var ActiveOrderIds=[];function PrintElem(id){var mywindow=window.open(rootpath+"/kds/order.php?id="+id,"PRINT","width=50px");return mywindow.document.close(),mywindow.focus(),setTimeout(()=>{mywindow.print()},"1000"),!0}function getDateByTimezone(date,timezone,culture){return date.toLocaleString(culture,{timeZone:timezone,dateStyle:"full"})}function getTimeByTimezone(date,timezone,culture){return date.toLocaleString(culture,{timeZone:timezone,timeStyle:"long"})}function getDateTimeByTimezone(date,timezone,culture){return date.toLocaleString(culture,{timeZone:timezone,dateStyle:"full",timeStyle:"long"})}function firstLetterCapitalize(_string){return _string.charAt(0).toUpperCase()+_string.slice(1)}function updateTime(){var now=new Date;const CopenhagenDate=getDateByTimezone(now,"Europe/Copenhagen","da-DK"),CopenhagenTime=getTimeByTimezone(now,"Europe/Copenhagen","da-DK");$("#time").html(firstLetterCapitalize(CopenhagenDate)+"<br/>"+CopenhagenTime)}function getdatestr(date,seperator){const year=date.getFullYear(),month=String(date.getMonth()+1).padStart(2,"0"),day=String(date.getDate()).padStart(2,"0"),joined=[day,month,year].join(seperator);return joined}function myFunction(){var now=new Date,later=new Date;later.setMinutes(now.getMinutes()+10),$("input[name='OrderDate']").each((function(){var oDate=new Date($(this).val());now>oDate?$($(this).parent()).toggleClass("bg-danger text-white"):later>oDate&&$($(this).parent()).toggleClass("bg-warning")}));var s=getdatestr(now,""),secrets=JSON.stringify(userSecrets);$.getJSON("../api/orders/"+s+"-"+s+"?secrets="+secrets).then(r=>{let toRemove=ActiveOrderIds.filter(x=>!r.includes(x)),toAdd=r.filter(x=>!ActiveOrderIds.includes(x));toRemove&&toRemove.length>0&&toRemove.forEach(x=>{$("#accordion_"+x).remove()}),toAdd&&toAdd.length>0&&toAdd.forEach(x=>{const index=r.findIndex(object=>object===x);if(0===index)$.get("create-card.php?id="+x,(function(resp){$("#orderCards").prepend(resp)}));else if(index===r.length-1)$.get("create-card.php?id="+x,(function(resp){$("#orderCards").append(resp)}));else{var idx=r[index+1];$.get("create-card.php?id="+x,(function(resp){$("#accordion_"+idx).before(resp)}))}playSound()}),ActiveOrderIds=r})}$((function(){setInterval(updateTime,1e3)}));