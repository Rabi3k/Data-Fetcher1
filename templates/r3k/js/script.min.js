var ActiveOrderIds=[];function PrintElem(id){var mywindow=window.open("/order/"+id,"PRINT");return mywindow.document.close(),mywindow.focus(),setTimeout(()=>{mywindow.print()},"1000"),!0}function getDateByTimezone(date,timezone,culture){return date.toLocaleString(culture,{timeZone:timezone,dateStyle:"full"})}function getTimeByTimezone(date,timezone,culture){return date.toLocaleString(culture,{timeZone:timezone,timeStyle:"long"})}function getDateTimeByTimezone(date,timezone,culture){return date.toLocaleString(culture,{timeZone:timezone,dateStyle:"full",timeStyle:"long"})}function firstLetterCapitalize(_string){return _string.charAt(0).toUpperCase()+_string.slice(1)}function updateTime(){var now=new Date;const CopenhagenDate=getDateByTimezone(now,"Europe/Copenhagen","da-DK"),CopenhagenTime=getTimeByTimezone(now,"Europe/Copenhagen","da-DK");$(".time-text").html(firstLetterCapitalize(CopenhagenDate)+"<br/>"+CopenhagenTime);var nowD=new Date(getDateTimeByTimezone(now,"Europe/Copenhagen","da-DK")),later=new Date;later.setMinutes(now.getMinutes()+10),$("input[name='OrderDate']").each((function(){var oDate=new Date($(this).val()),parent=$(this).parent(),timeRTxt=$($(this).parent()).parent().parent().children(".card-footer").children().children(".col-4").children("small"),timeR=new Date(oDate-nowD),t="";timeR.getHours()>0&&(t+=timeR.getHours()+"h"),timeR.getMinutes()>0&&(t+=timeR.getMinutes()+"m"),timeR.getSeconds()>0&&(t+=timeR.getSeconds()+"s"),now>oDate?($(parent).toggleClass("bg-danger text-white"),$(timeRTxt).text(t)):later>oDate?($(parent).toggleClass("bg-warning"),$(timeRTxt).text(t)):$(timeRTxt).text(t)}))}function getdatestr(date,seperator){const year=date.getFullYear(),month=String(date.getMonth()+1).padStart(2,"0"),day=String(date.getDate()).padStart(2,"0"),joined=[day,month,year].join(seperator);return joined}function myFunction(){var now,s=getdatestr(new Date,""),secrets=JSON.stringify(userSecrets);$.getJSON("../api/orders/"+s+"-"+s+"?secrets="+secrets).then(r=>{let toRemove=ActiveOrderIds.filter(x=>!r.includes(x)),toAdd=r.filter(x=>!ActiveOrderIds.includes(x));toRemove&&toRemove.length>0&&toRemove.forEach(x=>{$("#accordion_"+x).remove()}),toAdd&&toAdd.length>0&&toAdd.forEach(x=>{const index=r.findIndex(object=>object===x);$.get("/card/"+x,(function(resp){switch(index){case 0:$("#orderCards").prepend(resp);break;case r.length-1:$("#orderCards").append(resp);break;default:var idx=r[index+1];$("#accordion_"+idx).before(resp)}})),playSound()}),ActiveOrderIds=r,carouselWidth&&(carouselWidth=$(".carousel-inner")[0].scrollWidth,cardWidth=$(".carousel-item").width())})}$((function(){setInterval(updateTime,1e3)}));